import{u as D,j as e,r as g,h as y,H as Y,i as L,L as _,k as T,m as N}from"./index-1TFN091G.js";const I=({title:x,renewDate:r,daysLeft:h,icon:m,price:u})=>{const{t:i}=D();return e.jsxs("div",{className:"subscription-card",children:[e.jsxs("div",{className:"sub-left",children:[e.jsx("div",{className:"logo-wrapper",children:e.jsx("img",{src:m,alt:x})}),e.jsxs("div",{className:"sub-details",children:[e.jsx("span",{className:"sub-name",children:x}),e.jsx("span",{className:"sub-info",children:h<0?i("renew_overdue"):i("renew_info",{daysLeft:h})})]})]}),e.jsx("div",{className:"sub-right",children:e.jsx("span",{className:"sub-price",children:u})})]})},R=["S","M","T","W","T","F","S"],V=()=>{const{t:x}=D(),[r,h]=g.useState(new Date),[m,u]=g.useState([]),[i,p]=g.useState("month"),[v,S]=g.useState(null),[f,w]=g.useState([]);g.useEffect(()=>{const t=[];for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a.startsWith("subscription_"))try{const l=JSON.parse(localStorage.getItem(a));t.push(l)}catch{}}const s=t.flatMap(n=>y(n,N,i==="year"));return u(s),window.addEventListener("storage",()=>{const n=[];for(let l=0;l<localStorage.length;l++){const c=localStorage.key(l);if(c.startsWith("subscription_"))try{const d=JSON.parse(localStorage.getItem(c));n.push(d)}catch{}}const a=n.flatMap(l=>y(l,N,i==="year"));u(a)}),()=>window.removeEventListener("storage",()=>{})},[]);const M=r.toLocaleString("default",{month:"long"}),o=r.getFullYear(),F=((t,s)=>new Date(t,s+1,0).getDate())(o,r.getMonth()),k=e.jsxs("div",{className:"grid grid-cols-7 gap-1.5 p-4 mx-2 my-2 bg-white/30 backdrop-blur-md rounded-lg shadow-lg",children:[R.map((t,s)=>e.jsx("div",{className:"flex items-center justify-center h-10 text-gray-500 font-medium",children:t},s)),Array(new Date(o,r.getMonth(),1).getDay()).fill(null).map((t,s)=>e.jsx("div",{},`empty-${s}`)),Array.from({length:F},(t,s)=>{const n=s+1,a=n===r.getDate()&&r.getMonth()===new Date().getMonth()&&o===new Date().getFullYear(),l=m.some(c=>{const d=new Date(c.time);return d.getDate()===n&&d.getMonth()===r.getMonth()&&d.getFullYear()===o});return e.jsx("div",{onClick:()=>{const c=new Date(o,r.getMonth(),n);h(c),S(c);const d=m.filter(E=>{const j=new Date(E.time);return j.getDate()===c.getDate()&&j.getMonth()===c.getMonth()&&j.getFullYear()===c.getFullYear()});w(d)},className:`flex flex-col items-center justify-center h-12 w-12 rounded-lg cursor-pointer transition-transform transform
              ${a?"bg-blue-500 text-white scale-110":""}
              ${l&&!a?"bg-green-100 text-gray-900":""}
              hover:scale-105`,children:e.jsx("span",{className:"text-sm font-medium",children:n})},n)})]}),b=m.filter(t=>{const s=new Date(t.time);return i==="month"?s.getMonth()===r.getMonth()&&s.getFullYear()===r.getFullYear():s.getFullYear()===r.getFullYear()}),C=e.jsxs("div",{className:"px-4 py-2",children:[e.jsx("div",{className:"text-lg font-bold py-2",children:b.length?x("upcoming_renewals"):"☹️ "+x("no_upcoming_renewals")}),e.jsx("div",{className:"flex flex-col gap-3",children:b.sort((t,s)=>new Date(t.time)-new Date(s.time)).map(t=>e.jsx(I,{title:t.title,icon:t.icon,daysLeft:(()=>{const s=Math.ceil((new Date(t.time)-new Date)/864e5);return s<0?-1:s})()},t.id))})]});return e.jsxs("div",{className:"w-screen min-h-screen viewport",children:[e.jsx(Y,{showNavBack:!0,title:"Renewly",isAppTitle:!0,showIcons:!0}),e.jsxs("div",{className:"flex justify-center gap-4 py-2",children:[e.jsx("button",{className:`px-3 py-1 rounded ${i==="month"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>p("month"),children:"Month View"}),e.jsx("button",{className:`px-3 py-1 rounded ${i==="year"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>p("year"),children:"Year View"})]}),i==="month"&&e.jsxs("div",{className:"flex justify-between items-center px-4 py-2",children:[e.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 bg-transparent",onClick:()=>h(new Date(r.getFullYear(),r.getMonth()-1,1)),children:e.jsx(L,{})}),e.jsxs("h2",{className:"font-bold text-lg",children:[M," ",o]}),e.jsx(_,{to:"/test",children:e.jsx(T,{})})]}),i==="month"?e.jsxs(e.Fragment,{children:[k,f.length>0&&e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-transparent flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white p-4 rounded w-80 max-h-[80vh] overflow-y-auto",children:[e.jsxs("h3",{className:"font-bold mb-2",children:["Subscriptions for ",v.toLocaleDateString()]}),e.jsx("ul",{className:"flex flex-col gap-2",children:f.map(t=>e.jsxs("li",{className:"border p-2 rounded flex items-center gap-2",children:[t.icon&&e.jsx("img",{src:t.icon,alt:t.title,className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.title}),e.jsxs("div",{children:["Price: ",t.price]}),e.jsxs("div",{children:["Renewal Date: ",new Date(t.time).toLocaleDateString()]})]})]},t.id))}),e.jsx("button",{className:"mt-2 px-3 py-1 rounded bg-gray-200",onClick:()=>w([]),children:"Close"})]})}),C]}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-center font-bold text-lg mb-4",children:o}),e.jsx("div",{className:"grid grid-cols-3 gap-4 px-4",children:Array.from({length:12},(t,s)=>{const n=m.filter(a=>new Date(a.time).getMonth()===s&&new Date(a.time).getFullYear()===o).sort((a,l)=>new Date(a.time)-new Date(l.time));return e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:shadow-md hover:bg-white/20 transition",onClick:()=>{p("month"),h(new Date(o,s,1))},children:[e.jsx("h4",{className:"text-sm font-bold text-center mb-2",children:new Date(0,s).toLocaleString("default",{month:"short"})}),e.jsx("ul",{className:"mt-2 text-xs flex flex-col gap-1 min-h-[3rem]",children:n.length>0?e.jsxs(e.Fragment,{children:[n.slice(0,3).map(a=>e.jsxs("li",{className:"flex items-center gap-2",children:[a.icon&&e.jsx("img",{src:a.icon,alt:a.title,className:"w-4 h-4"}),e.jsxs("span",{children:[a.title," - ",a.price]})]},a.id)),n.length>3&&e.jsxs("li",{className:"text-gray-500 text-xs",children:["+",n.length-3," more"]})]}):e.jsx("li",{className:"text-gray-400 italic text-center",children:"No subscriptions"})})]},s)})})]})]})};export{V as default};

import{u as D,j as e,r as m,h as f,H as E,i as _,k as L,m as N}from"./index-DNyXqqgW.js";const T=({title:x,renewDate:r,daysLeft:h,icon:g,price:u})=>{const{t:i}=D();return e.jsxs("div",{className:"subscription-card",children:[e.jsxs("div",{className:"sub-left",children:[e.jsx("div",{className:"logo-wrapper",children:e.jsx("img",{src:g,alt:x})}),e.jsxs("div",{className:"sub-details",children:[e.jsx("span",{className:"sub-name",children:x}),e.jsx("span",{className:"sub-info",children:h<0?i("renew_overdue"):i("renew_info",{daysLeft:h})})]})]}),e.jsx("div",{className:"sub-right",children:e.jsx("span",{className:"sub-price",children:u})})]})},I=["S","M","T","W","T","F","S"],A=()=>{const{t:x}=D(),[r,h]=m.useState(new Date),[g,u]=m.useState([]),[i,p]=m.useState("month"),[v,S]=m.useState(null),[w,j]=m.useState([]);m.useEffect(()=>{const t=[];for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(n.startsWith("subscription_"))try{const l=JSON.parse(localStorage.getItem(n));t.push(l)}catch{}}const s=t.flatMap(a=>f(a,N,i==="year"));return u(s),window.addEventListener("storage",()=>{const a=[];for(let l=0;l<localStorage.length;l++){const c=localStorage.key(l);if(c.startsWith("subscription_"))try{const d=JSON.parse(localStorage.getItem(c));a.push(d)}catch{}}const n=a.flatMap(l=>f(l,N,i==="year"));u(n)}),()=>window.removeEventListener("storage",()=>{})},[]);const k=r.toLocaleString("default",{month:"long"}),o=r.getFullYear(),M=((t,s)=>new Date(t,s+1,0).getDate())(o,r.getMonth()),F=e.jsxs("div",{className:"grid grid-cols-7 gap-1.5 p-4 mx-2 my-2 bg-white/30 backdrop-blur-md rounded-lg shadow-lg",children:[I.map((t,s)=>e.jsx("div",{className:"flex items-center justify-center h-10 text-gray-500 font-medium",children:t},s)),Array(new Date(o,r.getMonth(),1).getDay()).fill(null).map((t,s)=>e.jsx("div",{},`empty-${s}`)),Array.from({length:M},(t,s)=>{const a=s+1,n=a===r.getDate()&&r.getMonth()===new Date().getMonth()&&o===new Date().getFullYear(),l=g.some(c=>{const d=new Date(c.time);return d.getDate()===a&&d.getMonth()===r.getMonth()&&d.getFullYear()===o});return e.jsx("div",{onClick:()=>{const c=new Date(o,r.getMonth(),a);h(c),S(c);const d=g.filter(Y=>{const b=new Date(Y.time);return b.getDate()===c.getDate()&&b.getMonth()===c.getMonth()&&b.getFullYear()===c.getFullYear()});j(d)},className:`flex flex-col items-center justify-center h-12 w-12 rounded-lg cursor-pointer transition-transform transform
              ${n?"bg-blue-500 text-white scale-110":""}
              ${l&&!n?"bg-green-100 text-gray-900":""}
              hover:scale-105`,children:e.jsx("span",{className:"text-sm font-medium",children:a})},a)})]}),y=g.filter(t=>{const s=new Date(t.time);return i==="month"?s.getMonth()===r.getMonth()&&s.getFullYear()===r.getFullYear():s.getFullYear()===r.getFullYear()}),C=e.jsxs("div",{className:"px-4 py-2",children:[e.jsx("div",{className:"text-lg font-bold py-2",children:y.length?x("upcoming_renewals"):"☹️ "+x("no_upcoming_renewals")}),e.jsx("div",{className:"flex flex-col gap-3",children:y.sort((t,s)=>new Date(t.time)-new Date(s.time)).map(t=>e.jsx(T,{title:t.title,icon:t.icon,daysLeft:(()=>{const s=Math.ceil((new Date(t.time)-new Date)/864e5);return s<0?-1:s})()},t.id))})]});return e.jsxs("div",{className:"w-screen min-h-screen viewport",children:[e.jsx(E,{showNavBack:!0,title:"Renewly",isAppTitle:!0,showIcons:!0}),e.jsxs("div",{className:"flex justify-center gap-4 py-2",children:[e.jsx("button",{className:`px-3 py-1 rounded ${i==="month"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>p("month"),children:"Month View"}),e.jsx("button",{className:`px-3 py-1 rounded ${i==="year"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>p("year"),children:"Year View"})]}),i==="month"&&e.jsxs("div",{className:"flex justify-between items-center px-4 py-2",children:[e.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 bg-transparent",onClick:()=>h(new Date(r.getFullYear(),r.getMonth()-1,1)),children:e.jsx(_,{})}),e.jsxs("h2",{className:"font-bold text-lg",children:[k," ",o]}),e.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 bg-transparent",onClick:()=>h(new Date(r.getFullYear(),r.getMonth()+1,1)),children:e.jsx(L,{})})]}),i==="month"?e.jsxs(e.Fragment,{children:[F,w.length>0&&e.jsx("div",{className:"calendar-modal fixed inset-0 backdrop-blur-sm bg-black/30 flex justify-center items-center z-50",children:e.jsxs("div",{className:"modal-content bg-white dark:bg-gray-900 p-4 rounded w-80 max-h-[80vh] overflow-y-auto shadow-lg",children:[e.jsxs("h3",{className:"font-bold mb-2 text-gray-900 dark:text-white",children:["Subscriptions for ",v.toLocaleDateString()]}),e.jsx("ul",{className:"flex flex-col gap-2",children:w.map(t=>e.jsxs("li",{className:"border p-2 rounded flex items-center gap-2 border-gray-200 dark:border-white-700",children:[t.icon&&e.jsx("img",{src:t.icon,alt:t.title,className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-text font-semibold text-gray-900",children:t.title}),e.jsxs("div",{className:"modal-text text-gray-700 dark:!text-white",children:["Price: ",t.price]}),e.jsxs("div",{className:"modal-text text-gray-700 dark:!text-white",children:["Renewal Date: ",new Date(t.time).toLocaleDateString()]})]})]},t.id))}),e.jsx("button",{className:"mt-2 px-3 py-1 rounded bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white",onClick:()=>j([]),children:"Close"})]})}),C]}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-center font-bold text-lg mb-4",children:o}),e.jsx("div",{className:"grid grid-cols-3 gap-4 px-4",children:Array.from({length:12},(t,s)=>{const a=g.filter(n=>new Date(n.time).getMonth()===s&&new Date(n.time).getFullYear()===o).sort((n,l)=>new Date(n.time)-new Date(l.time));return e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:shadow-md hover:bg-white/20 transition",onClick:()=>{p("month"),h(new Date(o,s,1))},children:[e.jsx("h4",{className:"text-sm font-bold text-center mb-2",children:new Date(0,s).toLocaleString("default",{month:"short"})}),e.jsx("ul",{className:"mt-2 text-xs flex flex-col gap-1 min-h-[3rem]",children:a.length>0?e.jsxs(e.Fragment,{children:[a.slice(0,3).map(n=>e.jsxs("li",{className:"flex items-center gap-2",children:[n.icon&&e.jsx("img",{src:n.icon,alt:n.title,className:"w-4 h-4"}),e.jsxs("span",{children:[n.title," - ",n.price]})]},n.id)),a.length>3&&e.jsxs("li",{className:"text-gray-500 text-xs",children:["+",a.length-3," more"]})]}):e.jsx("li",{className:"text-gray-400 italic text-center",children:"No subscriptions"})})]},s)})})]})]})};export{A as default};
